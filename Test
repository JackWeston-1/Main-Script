local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title = "Grow A Garden",
    Icon = "Info",
    Author = "Made By Minh",
    Folder = "CapyHub",
    Size = UDim2.fromOffset(520, 300),
    Transparent = true,
    Theme = "Dark",
    SideBarWidth = 190,
    HasOutline = true,
    Background = "", -- rbxassetid only
    BackgroundImageTransparency = 0.42,
    HideSearchBar = false,
    ScrollBarEnabled = false,
    User = {
        Enabled = true,
        Anonymous = true,
        Callback = function()
            print("clicked")
        end,
    },
})
    
Window:EditOpenButton({
	Title = "Capy Hub",
	CornerRadius = UDim.new(0, 10),
	Draggable = true
});

local MainTab = Window:Tab({
    Title = "Main",
    Icon = "house",
    Desc = "Main Section",
    Locked = false,
})

local BuyTab = Window:Tab({
    Title = "Shop",
    Icon = "shop",
    Locked = false,
})

Window:SelectTab(2) -- Number of Tab

local Button = MainTab:Button({
    Title = "Button",
    Desc = "Test Button",
    Locked = false,
    Callback = function()
        print("clicked")
    end
})

local Toggle = MainTab:Toggle({
    Title = "Auto Collect",
    Desc = "Tự động thu hoạch cây gần bạn",
    Icon = "leaf",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        print("Auto Collect: " .. tostring(state))

        -- Nếu bật Auto Collect
        task.spawn(function()
            while state do
                local player = game.Players.LocalPlayer
                local character = player.Character or player.CharacterAdded:Wait()
                local plot = getOwnedPlot()
                local farm = plot and plot:FindFirstChild("Important"):FindFirstChild("Plants_Physical")

                if farm and character then
                    local root = character:FindFirstChild("HumanoidRootPart")
                    if root then
                        for _, prompt in ipairs(farm:GetDescendants()) do
                            if prompt:IsA("ProximityPrompt") then
                                local dist = (root.Position - prompt.Parent.Position).Magnitude
                                if dist <= 20 then
                                    prompt.Exclusivity = Enum.ProximityPromptExclusivity.AlwaysShow
                                    prompt.MaxActivationDistance = 100
                                    prompt.RequiresLineOfSight = false
                                    prompt.Enabled = true
                                    fireproximityprompt(prompt, 1, true)
                                end
                            end
                        end
                    end
                end

                task.wait(1)

                -- Nếu người dùng tắt toggle, thoát vòng lặp
                if not Toggle._state then break end
            end
        end)
    end
})
